<link rel="import" href="chunk-descriptor.html">

<script>
    /**
     * @namespace VaadinAudioPlayer
     */
    window.VaadinAudioPlayer = window.VaadinAudioPlayer || {};

    /**
     * Decodes the audio data from ArrayBuffer, stores references
     * to source ArrayBuffer, decoded AudioBuffer promise, chunk descriptor.
     *
     * @memberOf VaadinAudioPlayer
     */
    VaadinAudioPlayer.ClientStreamBuffer = class ClientStreamBuffer {
        /**
         * @param {AudioContext} context
         * @param {ArrayBuffer} data
         */
        constructor(context, data) {
            this._context = context;

            /**
             * @type {VaadinAudioPlayer.ChunkDescriptor | null}
             */
            this.chunk = null;

            /**
             * @type {Promise<AudioBuffer>}
             */
            this.ready = new Promise((resolve, reject) => {
                this._context.decodeAudioData(data, resolve, reject);
            });
        }
    };
</script>